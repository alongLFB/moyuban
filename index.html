<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æ‘¸é±¼åŠå…¬å®¤</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Noto+Sans+SC:wght@400;700&display=swap");

      body {
        font-family: "Noto Serif SC", "SimSun", serif;
        max-width: 900px;
        margin: 20px auto;
        padding: 20px;
        background-color: #f4f1e8;
        background-image: radial-gradient(
            circle at 20% 80%,
            rgba(120, 119, 198, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 20%,
            rgba(255, 119, 198, 0.1) 0%,
            transparent 50%
          );
      }

      .container {
        background: linear-gradient(135deg, #f8f5e8 0%, #ede8d6 100%);
        border: 4px solid #d4af37;
        border-radius: 0;
        box-shadow: 0 0 0 2px #8b4513, 0 8px 25px rgba(0, 0, 0, 0.2),
          inset 0 1px 0 rgba(255, 255, 255, 0.3);
        position: relative;
        padding: 30px;
        margin: 20px 0;
      }

      .container::before {
        content: "";
        position: absolute;
        top: 10px;
        left: 10px;
        right: 10px;
        bottom: 10px;
        border: 2px solid #cd853f;
        pointer-events: none;
      }

      .country-selector {
        position: absolute;
        top: 15px;
        right: 15px;
        z-index: 100;
        display: flex;
        gap: 10px;
      }

      .country-select,
      .language-select {
        padding: 6px 10px;
        font-size: 12px;
        border: 2px solid #8b4513;
        background: linear-gradient(135deg, #f8f5e8 0%, #ede8d6 100%);
        color: #8b4513;
        cursor: pointer;
        font-family: "Noto Sans SC", sans-serif;
        font-weight: 700;
      }

      .header-section {
        text-align: center;
        border-bottom: 3px double #8b4513;
        padding-bottom: 20px;
        margin-bottom: 25px;
        background: linear-gradient(
          90deg,
          transparent 0%,
          #d4af37 20%,
          #d4af37 80%,
          transparent 100%
        );
        background-size: 100% 2px;
        background-repeat: no-repeat;
        background-position: center bottom;
      }

      .date-banner {
        background: #8b4513;
        color: #f8f5e8;
        padding: 8px 15px;
        display: inline-block;
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 10px;
        border-radius: 0;
        font-family: "Noto Sans SC", sans-serif;
      }

      .title {
        font-size: 36px;
        font-weight: bold;
        color: #8b4513;
        margin: 15px 0;
        text-shadow: 2px 2px 0px #d4af37;
        letter-spacing: 3px;
        font-family: "Noto Serif SC", serif;
      }

      .subtitle {
        font-size: 14px;
        color: #8b4513;
        font-style: italic;
        margin-bottom: 15px;
      }

      .section {
        margin: 20px 0;
        padding: 15px;
        border: 2px solid #cd853f;
        background: rgba(255, 255, 255, 0.3);
        position: relative;
      }

      .section::before {
        content: "";
        position: absolute;
        top: -2px;
        left: -2px;
        right: -2px;
        bottom: -2px;
        border: 1px solid #d4af37;
        pointer-events: none;
      }

      .section-title {
        background: #8b4513;
        color: #f8f5e8;
        padding: 8px 15px;
        margin: -15px -15px 15px -15px;
        font-weight: bold;
        font-size: 16px;
        text-align: center;
        font-family: "Noto Sans SC", sans-serif;
      }

      .current-time {
        text-align: center;
        font-size: 24px;
        font-weight: bold;
        color: #8b4513;
        margin: 15px 0;
        padding: 15px;
        background: radial-gradient(
          circle,
          rgba(212, 175, 55, 0.2) 0%,
          transparent 70%
        );
        border: 2px dashed #d4af37;
        font-family: "Noto Sans SC", sans-serif;
      }

      .two-column {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-top: 20px;
      }

      .column {
        padding: 15px;
        border: 2px solid #cd853f;
        background: rgba(255, 255, 255, 0.2);
      }

      .holiday-item {
        border-bottom: 1px dotted #8b4513;
        padding: 8px 0;
        margin-bottom: 8px;
      }

      .holiday-item:last-child {
        border-bottom: none;
        margin-bottom: 0;
      }

      .holiday-name {
        font-weight: bold;
        color: #8b4513;
        font-size: 16px;
      }

      .holiday-days {
        color: #d4af37;
        font-weight: bold;
        font-size: 18px;
      }

      .copy-button {
        display: block;
        width: 250px;
        margin: 30px auto;
        padding: 15px 25px;
        font-size: 18px;
        color: #f8f5e8;
        background: linear-gradient(135deg, #8b4513 0%, #a0522d 100%);
        border: 3px solid #d4af37;
        cursor: pointer;
        transition: all 0.3s;
        font-family: "Noto Sans SC", sans-serif;
        font-weight: bold;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .copy-button:hover {
        background: linear-gradient(135deg, #a0522d 0%, #8b4513 100%);
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(139, 69, 19, 0.4);
      }

      .copy-feedback {
        display: none;
        text-align: center;
        color: #8b4513;
        margin-top: 15px;
        font-weight: bold;
        font-size: 16px;
        padding: 10px;
        background: rgba(212, 175, 55, 0.2);
        border: 2px solid #d4af37;
      }

      .decorative-border {
        height: 3px;
        background: repeating-linear-gradient(
          90deg,
          #8b4513 0px,
          #8b4513 10px,
          #d4af37 10px,
          #d4af37 20px
        );
        margin: 20px 0;
      }

      .fish-emoji {
        font-size: 24px;
        display: inline-block;
        animation: swim 3s ease-in-out infinite;
      }

      @keyframes swim {
        0%,
        100% {
          transform: translateX(0) rotate(0deg);
        }
        50% {
          transform: translateX(10px) rotate(5deg);
        }
      }

      p {
        line-height: 1.6;
        color: #2c1810;
        margin: 10px 0;
      }

      .greeting-text {
        font-size: 18px;
        font-weight: bold;
        color: #8b4513;
        text-align: center;
        margin: 15px 0;
      }

      .reminder-text {
        font-style: italic;
        color: #5d4037;
        line-height: 1.8;
      }
    </style>
  </head>

  <body>
    <div class="country-selector">
      <select
        id="countrySelect"
        class="country-select"
        onchange="updateContent()"
      >
        <option value="CN">ä¸­å›½</option>
        <option value="UAE">é˜¿è”é…‹</option>
        <option value="UK">è‹±å›½</option>
        <option value="KR">éŸ©å›½</option>
        <option value="US">ç¾å›½</option>
      </select>
      <select
        id="languageSelect"
        class="language-select"
        onchange="updateContent()"
      >
        <option value="zh-CN">ä¸­æ–‡</option>
        <option value="en-US">English</option>
      </select>
    </div>

    <div class="container">
      <div class="header-section">
        <div class="date-banner" id="dateInfo"></div>
        <h1 class="title" id="webTitle"></h1>
        <div class="subtitle">
          ä»Šå¤©ä½ æ‘¸é±¼äº†å—ï¼Ÿ <span class="fish-emoji">ğŸ </span>
        </div>
        <div class="decorative-border"></div>
      </div>

      <div class="current-time" id="currentTime"></div>

      <div id="mainContent"></div>

      <div class="decorative-border"></div>

      <button
        id="copyButton"
        class="copy-button"
        onclick="copyContent()"
      ></button>
      <div id="copyFeedback" class="copy-feedback"></div>
    </div>

    <script>
      // åœ¨è„šæœ¬å¼€å§‹å¤„æ·»åŠ URLå‚æ•°å¤„ç†å‡½æ•°
      function getUrlParams() {
        const urlParams = new URLSearchParams(window.location.search);
        return {
          country: urlParams.get("country"),
          language: urlParams.get("language"),
        };
      }

      let isInitializing = false; // æ·»åŠ æ ‡å¿—å˜é‡
      let isPopstateEvent = false; // æ·»åŠ popstateäº‹ä»¶æ ‡å¿—

      function updateUrl() {
        // åªæœ‰åœ¨éåˆå§‹åŒ–å’Œépopstateäº‹ä»¶æ—¶æ‰åˆ›å»ºæ–°çš„å†å²è®°å½•
        if (!isInitializing && !isPopstateEvent) {
          const country = document.getElementById("countrySelect").value;
          const language = document.getElementById("languageSelect").value;
          const url = new URL(window.location);
          url.searchParams.set("country", country);
          url.searchParams.set("language", language);
          window.history.pushState({ country, language }, "", url);
        }
      }

      function initializeFromUrl() {
        const params = getUrlParams();

        if (params.country) {
          const countrySelect = document.getElementById("countrySelect");
          if (
            [...countrySelect.options].some(
              (option) => option.value === params.country
            )
          ) {
            countrySelect.value = params.country;
          }
        }

        if (params.language) {
          const languageSelect = document.getElementById("languageSelect");
          if (
            [...languageSelect.options].some(
              (option) => option.value === params.language
            )
          ) {
            languageSelect.value = params.language;
          }
        }
      }

      // å„å›½èŠ‚å‡æ—¥æ•°æ®
      const holidaysByCountry = {
        CN: [
          {
            name: "æ¸…æ˜",
            month: 4,
            day: 4,
            description: "4æœˆ4æ—¥ï¼ˆå‘¨äº”ï¼‰è‡³6æ—¥ï¼ˆå‘¨æ—¥ï¼‰æ”¾å‡ï¼Œå…±3å¤©",
          },
          {
            name: "äº”ä¸€",
            month: 5,
            day: 1,
            description:
              "5æœˆ1æ—¥ï¼ˆå‘¨å››ï¼‰è‡³5æ—¥ï¼ˆå‘¨ä¸€ï¼‰æ”¾å‡è°ƒä¼‘ï¼Œå…±5å¤©ã€‚4æœˆ27æ—¥ï¼ˆå‘¨æ—¥ï¼‰ä¸Šç­",
          },
          {
            name: "ç«¯åˆ",
            month: 5,
            day: 31,
            description: "5æœˆ31æ—¥ï¼ˆå‘¨å…­ï¼‰è‡³6æœˆ2æ—¥ï¼ˆå‘¨ä¸€ï¼‰æ”¾å‡ï¼Œå…±3å¤©",
          },
          {
            name: "å›½åº†èŠ‚ã€ä¸­ç§‹èŠ‚",
            month: 10,
            day: 1,
            description:
              "10æœˆ1æ—¥ï¼ˆå‘¨ä¸‰ï¼‰è‡³8æ—¥ï¼ˆå‘¨ä¸‰ï¼‰æ”¾å‡è°ƒä¼‘ï¼Œå…±8å¤©ã€‚9æœˆ28æ—¥ï¼ˆå‘¨æ—¥ï¼‰ã€10æœˆ11æ—¥ï¼ˆå‘¨å…­ï¼‰ä¸Šç­",
          },
        ],
        UAE: [
          {
            name: "å¼€æ–‹èŠ‚",
            month: 3,
            day: 29,
            description:
              "2025å¹´3æœˆ29æ—¥ï¼ˆå‘¨å…­ï¼‰-4æœˆ1æ—¥ï¼ˆå‘¨äºŒï¼‰ï¼Œå…±4å¤©ã€‚å¼€æ–‹èŠ‚æ ‡å¿—ç€æ–‹æœˆçš„ç»“æŸ",
          },
          {
            name: "é˜¿æ‹‰æ³•ç‰¹æ—¥",
            month: 6,
            day: 5,
            description: "2025å¹´6æœˆ5æ—¥ï¼ˆå‘¨å››ï¼‰ï¼Œæœè§æ´»åŠ¨çš„é‡è¦æ—¥æœŸ",
          },
          {
            name: "å®°ç‰²èŠ‚",
            month: 6,
            day: 6,
            description:
              "2025å¹´6æœˆ6æ—¥ï¼ˆå‘¨äº”ï¼‰-8æ—¥ï¼ˆå‘¨æ—¥ï¼‰ï¼Œå…±3å¤©ã€‚ä¼Šæ–¯å…°æ•™æœ€é‡è¦çš„èŠ‚æ—¥ä¹‹ä¸€",
          },
          {
            name: "ä¼Šæ–¯å…°æ–°å¹´",
            month: 6,
            day: 26,
            description: "2025å¹´6æœˆ26æ—¥ï¼ˆå‘¨å››ï¼‰ï¼Œä¼Šæ–¯å…°æ–°å¹´",
          },
          {
            name: "å…ˆçŸ¥è¯è¾°",
            month: 9,
            day: 4,
            description: "2025å¹´9æœˆ4æ—¥ï¼ˆå‘¨å››ï¼‰ï¼Œçºªå¿µå…ˆçŸ¥ç©†ç½•é»˜å¾·è¯è¾°",
          },
          {
            name: "çƒˆå£«æ—¥",
            month: 12,
            day: 1,
            description: "2025å¹´12æœˆ1æ—¥ï¼ˆå‘¨ä¸€ï¼‰ï¼Œçºªå¿µä¸ºå›½æèº¯çš„é˜¿è”é…‹çƒˆå£«",
          },
          {
            name: "å›½åº†èŠ‚",
            month: 12,
            day: 2,
            description:
              "2025å¹´12æœˆ2æ—¥ï¼ˆå‘¨äºŒï¼‰-3æ—¥ï¼ˆå‘¨ä¸‰ï¼‰ï¼Œå…±2å¤©ã€‚åº†ç¥é˜¿è”é…‹å»ºå›½54å‘¨å¹´",
          },
        ],
        UK: [
          {
            name: "Good Friday",
            month: 4,
            day: 18,
            description: "Bank Holiday",
          },
          {
            name: "Easter Monday",
            month: 4,
            day: 21,
            description: "Bank Holiday",
          },
          {
            name: "Early May bank holiday",
            month: 5,
            day: 5,
            description: "Bank Holiday",
          },
          {
            name: "Spring bank holiday",
            month: 5,
            day: 26,
            description: "Bank Holiday",
          },
          {
            name: "Summer bank holiday",
            month: 8,
            day: 25,
            description: "Bank Holiday",
          },
          {
            name: "Christmas Day",
            month: 12,
            day: 25,
            description: "Bank Holiday",
          },
          {
            name: "Boxing Day",
            month: 12,
            day: 26,
            description: "Bank Holiday",
          },
        ],
        KR: [
          { name: "ì‚¼ì¼ì ˆ", month: 3, day: 1, description: "3.1ì ˆ" },
          {
            name: "ì‚¼ì¼ì ˆ",
            month: 3,
            day: 3,
            description: "3Â·1 ìš´ë™/ì‚¼ì¼ì ˆ íœ´ì¼",
          },
          { name: "ì–´ë¦°ì´ë‚ ", month: 5, day: 5, description: "ì–´ë¦°ì´ë‚ " },
          {
            name: "ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ ",
            month: 5,
            day: 6,
            description: "ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ ",
          },
          { name: "í˜„ì¶©ì¼", month: 6, day: 6, description: "í˜„ì¶©ì¼" },
          { name: "ê´‘ë³µì ˆ", month: 8, day: 15, description: "ê´‘ë³µì ˆ" },
          { name: "ì¶”ì„", month: 9, day: 30, description: "ìŒë ¥ ì¶”ì„" },
        ],
        US: [
          {
            name: "New Year's Day",
            month: 1,
            day: 1,
            description: "Federal Holiday",
          },
          {
            name: "Martin Luther King Jr. Day",
            month: 1,
            day: 20,
            description: "Federal Holiday",
          },
          {
            name: "Washington's Birthday",
            month: 2,
            day: 17,
            description: "Federal Holiday",
          },
          {
            name: "Memorial Day",
            month: 5,
            day: 26,
            description: "Federal Holiday",
          },
          {
            name: "Juneteenth National Independence Day",
            month: 6,
            day: 19,
            description: "Federal Holiday",
          },
          {
            name: "Independence Day",
            month: 7,
            day: 4,
            description: "Federal Holiday",
          },
          {
            name: "Labor Day",
            month: 9,
            day: 1,
            description: "Federal Holiday",
          },
          {
            name: "Columbus Day",
            month: 10,
            day: 13,
            description: "Federal Holiday",
          },
          {
            name: "Veterans Day",
            month: 11,
            day: 11,
            description: "Federal Holiday",
          },
          {
            name: "Thanksgiving Day",
            month: 11,
            day: 27,
            description: "Federal Holiday",
          },
          {
            name: "Christmas Day",
            month: 12,
            day: 25,
            description: "Federal Holiday",
          },
        ],
      };

      const translations = {
        "zh-CN": {
          webTitle: "ã€æ‘¸é±¼åŠã€‘æ¸©é¦¨æé†’",
          holiday: `èŠ‚å‡æ—¥`,
          salary: "ã€å·¥èµ„ã€‘",
          daysToPayday: "è·ç¦»ã€æœˆåº•å‘å·¥èµ„ã€‘ï¼š",
          daysToPayday5: "è·ç¦»ã€05å·å‘å·¥èµ„ã€‘ï¼š",
          daysToPayday10: "è·ç¦»ã€10å·å‘å·¥èµ„ã€‘ï¼š",
          daysToPayday15: "è·ç¦»ã€15å·å‘å·¥èµ„ã€‘ï¼š",
          daysToPayday20: "è·ç¦»ã€20å·å‘å·¥èµ„ã€‘ï¼š",
          daysToPayday25: "è·ç¦»ã€25å·å‘å·¥èµ„ã€‘ï¼š",
          daysToSaturday: `è·ç¦»ã€å‘¨å…­ã€‘è¿˜æœ‰ `,
          days: "å¤©",
          hours: "å°æ—¶",
          yearPassed: (daysPassed, hoursPassed) =>
            `${new Date().getFullYear()}å¹´å·²ç»è¿‡å» ${daysPassed} å¤© ${hoursPassed} å°æ—¶ï¼Œ`,
          todayIs: (weekdays) =>
            `ä»Šå¤©æ˜¯ ${new Date().getFullYear()}å¹´${
              new Date().getMonth() + 1
            }æœˆ${new Date().getDate()}æ—¥ï¼Œæ˜ŸæœŸ${weekdays[new Date().getDay()]}`,
          greeting: "ä½ å¥½ï¼Œæ‘¸é±¼äººï¼å·¥ä½œå†å¿™ï¼Œä¸€å®šä¸è¦å¿˜è®°æ‘¸é±¼å“¦ï¼",
          workReminder:
            "æœ‰äº‹æ²¡äº‹èµ·èº«å»èŒ¶æ°´é—´ï¼Œå»å•æ‰€ï¼Œå»èµ°å»Šèµ°èµ°ï¼Œå»æ‰¾åŒäº‹èŠèŠå…«å¦\nåˆ«è€åœ¨å·¥ä½ä¸Šåç€ï¼Œé’±æ˜¯è€æ¿çš„ä½†å‘½æ˜¯è‡ªå·±çš„ã€‚",
          timeInCountry: (countryName, countryTime, countryTimezone) =>
            `å½“å‰${countryName}æ—¶é—´ï¼š${countryTime} (${countryTimezone})`,
          currentTimeString: (timeString, timezoneOffsetString) =>
            `å½“å‰æœ¬åœ°æ—¶é—´ï¼š${timeString} (${timezoneOffsetString})`,
          holidays: (countryName) => `ã€${countryName}èŠ‚å‡æ—¥ã€‘`,
          copySuccess: "å¤åˆ¶æˆåŠŸï¼",
          copyFailed: "å¤åˆ¶å¤±è´¥ï¼Œè¯·é‡è¯•",
          countries: {
            CN: "ä¸­å›½",
            UAE: "é˜¿è”é…‹",
            UK: "è‹±å›½",
            KR: "éŸ©å›½",
            US: "ç¾å›½",
          },
          daysToHoliday: "è·ç¦»",
          still: "è¿˜æœ‰",
          copyButton: "ä¸€é”®å¤åˆ¶æ‘¸é±¼æé†’",
          weekdays: ["æ—¥", "ä¸€", "äºŒ", "ä¸‰", "å››", "äº”", "å…­"],
        },
        "en-US": {
          webTitle: "[Fish-Touching Office] Gentle Reminder",
          holiday: `Holidays`,
          salary: "ã€Salaryã€‘",
          daysToPayday: "Days to [End of month payday]:",
          daysToPayday5: "Days to [5th payday]:",
          daysToPayday10: "Days to [10th payday]:",
          daysToPayday15: "Days to [15th payday]:",
          daysToPayday20: "Days to [20th payday]:",
          daysToPayday25: "Days to [25th payday]:",
          daysToSaturday: `Days to [Saturday]: `,
          days: "days",
          hours: "hours",
          yearPassed: (daysPassed, hoursPassed) =>
            `${new Date().getFullYear()} has passed ${daysPassed} days and ${hoursPassed} hours.`,
          todayIs: (weekdays) =>
            `Today is ${new Date().getFullYear()}/${
              new Date().getMonth() + 1
            }/${new Date().getDate()}, ${weekdays[new Date().getDay()]}`,
          greeting:
            "Hello, fish-toucher! No matter how busy you are, don't forget to touch fish!",
          workReminder:
            "Take a break and walk around the pantry, restroom, or hallway. Chat with colleagues about gossip.\nDon't just sit at your desk all the time. The money belongs to the boss, but your life is your own.",
          timeInCountry: (countryName, countryTime, countryTimezone) =>
            `Current time in ${countryName}: ${countryTime} (${countryTimezone})`,
          currentTimeString: (timeString, timezoneOffsetString) =>
            `Current local time: ${timeString} (${timezoneOffsetString})`,
          holidays: (countryName) => `ã€${countryName} Holidaysã€‘`,
          copySuccess: "Copy Success!",
          copyFailed: "Copy failed, please try again",
          countries: {
            CN: "China",
            UAE: "United Arab Emirates",
            UK: "United Kingdom",
            KR: "South Korea",
            US: "United States",
          },
          daysToHoliday: "Days to",
          still: "still",
          copyButton: "Copy Fish-Touching Reminder",
          weekdays: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
        },
      };

      // Function to get the current language data
      function getLangData() {
        const language = document.getElementById("languageSelect").value;
        return translations[language];
      }

      // Add this new function after the getLangData() function
      function updateCountrySelectOptions() {
        const langData = getLangData();
        const countrySelect = document.getElementById("countrySelect");
        const currentValue = countrySelect.value;

        // Clear existing options
        countrySelect.innerHTML = "";

        // Add new options with translated names
        Object.entries(langData.countries).forEach(([code, name]) => {
          const option = document.createElement("option");
          option.value = code;
          option.textContent = name;
          countrySelect.appendChild(option);
        });

        // Restore the previously selected value
        countrySelect.value = currentValue;
      }

      function padZero(num) {
        return num < 10 ? "0" + num : num;
      }

      function updateCurrentTime() {
        const now = new Date();
        const timeString = `${padZero(now.getHours())}:${padZero(
          now.getMinutes()
        )}:${padZero(now.getSeconds())}`;
        const timezoneOffsetString = getTimezoneOffsetString();
        const langData = getLangData();
        document.getElementById("currentTime").textContent =
          langData.currentTimeString(timeString, timezoneOffsetString);
      }

      function updateCurrentCountryTime() {
        // è¿™ä¸ªå‡½æ•°ç°åœ¨ä¸éœ€è¦äº†ï¼Œå› ä¸ºå›½å®¶æ—¶é—´å·²ç»é›†æˆåˆ° updateContent ä¸­
        // å¯ä»¥ç›´æ¥åˆ é™¤è¿™ä¸ªå‡½æ•°ï¼Œæˆ–è€…ä¿ç•™ä½†ä¸æ‰§è¡Œä»»ä½•æ“ä½œ
        return;
      }

      function getTimezoneOffsetString() {
        const now = new Date();
        const timezoneOffset = now.getTimezoneOffset();
        const timezoneOffsetHours = -timezoneOffset / 60;
        return `UTC${
          timezoneOffsetHours >= 0 ? "+" : ""
        }${timezoneOffsetHours}`;
      }

      function getCountryName(code) {
        const langData = getLangData();
        return langData.countries[code] || code;
      }

      function getDaysToHoliday(month, day) {
        const now = new Date();
        let targetDate = new Date(now.getFullYear(), month - 1, day);
        if (targetDate < now) {
          targetDate.setFullYear(targetDate.getFullYear() + 1);
        }
        const diff = targetDate - now;
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor(
          (diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
        );
        return { days, hours };
      }

      function getHolidaySection() {
        const country = document.getElementById("countrySelect").value;
        const holidays = holidaysByCountry[country];
        const langData = getLangData();
        const countryName = getCountryName(country);

        let holidayHtml = `<div class="section-title">ğŸ‰ ${langData.holidays(
          countryName
        )}</div>`;

        // è¿‡æ»¤å‡ºå½“å‰æ—¥æœŸä¹‹åçš„èŠ‚å‡æ—¥
        const now = new Date();
        // è®¾ç½®ä¸ºä»Šå¤©çš„å¼€å§‹æ—¶é—´ï¼Œä¾¿äºå‡†ç¡®æ¯”è¾ƒ
        const today = new Date(
          now.getFullYear(),
          now.getMonth(),
          now.getDate()
        );

        const upcomingHolidays = holidays.filter((holiday) => {
          let targetDate = new Date(
            now.getFullYear(),
            holiday.month - 1,
            holiday.day
          );
          // å¦‚æœä»Šå¹´çš„èŠ‚å‡æ—¥å·²ç»è¿‡å»ï¼Œåˆ™ä¸æ˜¾ç¤ºï¼Œä¹Ÿä¸æ˜¾ç¤ºæ˜å¹´çš„
          return targetDate > today;
        });

        if (upcomingHolidays.length === 0) {
          holidayHtml += `
                    <div class="holiday-item">
                        <div style="text-align: center; color: #666; font-style: italic;">
                            æš‚æ— å³å°†åˆ°æ¥çš„èŠ‚å‡æ—¥
                        </div>
                    </div>
                `;
        } else {
          upcomingHolidays.forEach((holiday) => {
            const { days, hours } = getDaysToHoliday(
              holiday.month,
              holiday.day
            );
            holidayHtml += `
                      <div class="holiday-item">
                          <div class="holiday-name">${holiday.name}</div>
                          <div>${langData.daysToHoliday} <span class="holiday-days">${days}</span> ${langData.days} <span class="holiday-days">${hours}</span> ${langData.hours}</div>
                          <div style="font-size: 12px; color: #666; font-style: italic;">${holiday.description}</div>
                      </div>
                  `;
          });
        }

        return holidayHtml;
      }

      // Function to get the timezone for a specific country
      function getTimezoneForCountry(countryCode) {
        const timezones = {
          CN: "Asia/Shanghai", // ä¸­å›½
          UAE: "Asia/Dubai", // é˜¿è”é…‹
          UK: "Europe/London", // è‹±å›½
          KR: "Asia/Seoul", // éŸ©å›½
          US: "America/New_York", // ç¾å›½ (Example: New York)
        };
        return timezones[countryCode] || "UTC"; // Default to UTC if not found
      }

      function getDaysToDate(day) {
        const now = new Date();
        let targetDate = new Date(now);
        targetDate.setDate(day);
        if (now.getDate() > day) {
          targetDate.setMonth(targetDate.getMonth() + 1);
        }
        return Math.ceil((targetDate - now) / (1000 * 60 * 60 * 24));
      }

      function updateContent() {
        updateCountrySelectOptions();
        updateCurrentTime();

        const now = new Date();
        const timeString = `${padZero(now.getHours())}:${padZero(
          now.getMinutes()
        )}:${padZero(now.getSeconds())}`;
        const langData = getLangData();
        const country = document.getElementById("countrySelect").value;
        const countryName = getCountryName(country);
        const weekdays = langData.weekdays;
        const daysToSaturday = (6 - now.getDay() + 7) % 7 || 7;
        const daysPassed = Math.floor(
          (now - new Date(now.getFullYear(), 0, 1)) / (24 * 60 * 60 * 1000)
        );
        const hoursPassed = now.getHours();

        // Get the timezone for the selected country
        const countryTimezone = getTimezoneForCountry(country);

        // Get the current time in the selected country's timezone
        const countryTime = new Date().toLocaleString("en-US", {
          timeZone: countryTimezone,
        });

        // Update date banner
        document.getElementById(
          "dateInfo"
        ).textContent = `${now.getFullYear()}å¹´${
          now.getMonth() + 1
        }æœˆ${now.getDate()}æ—¥ æ˜ŸæœŸ${weekdays[now.getDay()]}`;

        document.getElementById("webTitle").textContent = langData.webTitle;

        const content = `
                <div class="section">
                    <div class="section-title">ğŸŒ å…¨çƒæ—¶é—´</div>
                    <div style="text-align: center; font-size: 18px; color: #8b4513;">
                        ${langData.timeInCountry(
                          countryName,
                          countryTime,
                          countryTimezone
                        )}
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">ğŸ“… æ—¶å…‰æµé€</div>
                    <div style="text-align: center; font-size: 16px; line-height: 1.8;">
                        ${langData.yearPassed(daysPassed, hoursPassed)}<br>
                        ${langData.todayIs(weekdays)}
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-title">ğŸ  æ‘¸é±¼å®£è¨€</div>
                    <div class="greeting-text">${langData.greeting}</div>
                    <div class="reminder-text">${langData.workReminder}</div>
                </div>

                <div class="two-column">
                    <div class="column">
                        <div class="section-title">ğŸ’° å‘è–ªå€’è®¡æ—¶</div>
                        <p><strong>${
                          langData.daysToPayday
                        }</strong> <span class="holiday-days">${getDaysToDate(
          30
        )}</span> ${langData.days}</p>
                        <p><strong>${
                          langData.daysToPayday5
                        }</strong> <span class="holiday-days">${getDaysToDate(
          5
        )}</span> ${langData.days}</p>
                        <p><strong>${
                          langData.daysToPayday10
                        }</strong> <span class="holiday-days">${getDaysToDate(
          10
        )}</span> ${langData.days}</p>
                        <p><strong>${
                          langData.daysToPayday15
                        }</strong> <span class="holiday-days">${getDaysToDate(
          15
        )}</span> ${langData.days}</p>
                        <p><strong>${
                          langData.daysToPayday20
                        }</strong> <span class="holiday-days">${getDaysToDate(
          20
        )}</span> ${langData.days}</p>
                        <p><strong>${
                          langData.daysToPayday25
                        }</strong> <span class="holiday-days">${getDaysToDate(
          25
        )}</span> ${langData.days}</p>
                        <p><strong>${
                          langData.daysToSaturday
                        }</strong> <span class="holiday-days">${daysToSaturday}</span> ${
          langData.days
        }</p>
                    </div>
                    
                    <div class="column">
                        ${getHolidaySection()}
                    </div>
                </div>
            `;

        document.getElementById("mainContent").innerHTML = content;
        document.getElementById("copyButton").textContent = langData.copyButton;

        // æ›´æ–°URLå‚æ•°
        updateUrl();
      }

      function getTextContent() {
        const now = new Date();
        const timeString = `${padZero(now.getHours())}:${padZero(
          now.getMinutes()
        )}:${padZero(now.getSeconds())}`;
        const langData = getLangData();
        const country = document.getElementById("countrySelect").value;
        const countryName = getCountryName(country);
        const weekdays = langData.weekdays;
        const daysToSaturday = (6 - now.getDay() + 7) % 7 || 7;
        const daysPassed = Math.floor(
          (now - new Date(now.getFullYear(), 0, 1)) / (24 * 60 * 60 * 1000)
        );
        const hoursPassed = now.getHours();

        // Get the timezone for the selected country
        const countryTimezone = getTimezoneForCountry(country);

        // Get the current time in the selected country's timezone
        const countryTime = new Date().toLocaleString("en-US", {
          timeZone: countryTimezone,
        });

        const timezoneOffsetString = getTimezoneOffsetString();

        let text = `${langData.webTitle}
${langData.currentTimeString(timeString, timezoneOffsetString)}
${langData.timeInCountry(countryName, countryTime, countryTimezone)}
${langData.yearPassed(daysPassed, hoursPassed)}
${langData.todayIs(weekdays)}

${langData.greeting}
${langData.workReminder}

${langData.salary}
${langData.daysToPayday}ï¼š${getDaysToDate(30)}${langData.days}
${langData.daysToPayday5}ï¼š${getDaysToDate(5)}${langData.days}
${langData.daysToPayday10}ï¼š${getDaysToDate(10)}${langData.days}
${langData.daysToPayday15}ï¼š${getDaysToDate(15)}${langData.days}
${langData.daysToPayday20}ï¼š${getDaysToDate(20)}${langData.days}
${langData.daysToPayday25}ï¼š${getDaysToDate(25)}${langData.days}
${langData.daysToSaturday}${daysToSaturday}${langData.days}

        ${langData.holidays(countryName)}\n`;

        // è¿‡æ»¤å‡ºå½“å‰æ—¥æœŸä¹‹åçš„èŠ‚å‡æ—¥
        const today = new Date(
          now.getFullYear(),
          now.getMonth(),
          now.getDate()
        );
        const upcomingHolidays = holidaysByCountry[country].filter(
          (holiday) => {
            let targetDate = new Date(
              now.getFullYear(),
              holiday.month - 1,
              holiday.day
            );
            // å¦‚æœä»Šå¹´çš„èŠ‚å‡æ—¥å·²ç»è¿‡å»ï¼Œåˆ™ä¸æ˜¾ç¤ºï¼Œä¹Ÿä¸æ˜¾ç¤ºæ˜å¹´çš„
            return targetDate > today;
          }
        );

        if (upcomingHolidays.length === 0) {
          text += "æš‚æ— å³å°†åˆ°æ¥çš„èŠ‚å‡æ—¥\n";
        } else {
          upcomingHolidays.forEach((holiday) => {
            const { days, hours } = getDaysToHoliday(
              holiday.month,
              holiday.day
            );
            text += `${langData.daysToHoliday} ${holiday.name} ${langData.still} : ${days} ${langData.days} ${hours} ${langData.hours}. ${holiday.description}\n`;
          });
        }

        return text;
      }

      async function copyContent() {
        const textContent = getTextContent();
        const langData = getLangData();
        try {
          await navigator.clipboard.writeText(textContent);
          const feedback = document.getElementById("copyFeedback");
          feedback.textContent = langData.copySuccess;
          feedback.style.display = "block";
          setTimeout(() => {
            feedback.style.display = "none";
          }, 2000);
        } catch (err) {
          alert(langData.copyFailed);
        }
      }

      // ä¿®æ”¹æµè§ˆå™¨å‰è¿›/åé€€æŒ‰é’®æ”¯æŒ
      window.addEventListener("popstate", function (event) {
        console.log("popstate triggered", event.state); // è°ƒè¯•ç”¨
        isPopstateEvent = true; // è®¾ç½®popstateæ ‡å¿—
        initializeFromUrl();
        updateContent();
        isPopstateEvent = false; // é‡ç½®æ ‡å¿—
      });

      // ä¿®æ”¹åˆå§‹åŒ–éƒ¨åˆ†
      isInitializing = true; // å¼€å§‹åˆå§‹åŒ–
      initializeFromUrl();
      updateContent();
      updateCurrentTime();
      // updateCurrentCountryTime(); // åˆ é™¤è¿™è¡Œ
      isInitializing = false; // åˆå§‹åŒ–å®Œæˆ

      // æ—¶é—´æ›´æ–°ï¼šæ¯ç§’æ›´æ–°æ—¶åˆ†ç§’
      setInterval(updateCurrentTime, 1000);
      // setInterval(updateCurrentCountryTime, 1000); // åˆ é™¤è¿™è¡Œ

      // å†…å®¹æ›´æ–°ï¼šæ¯åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡
      setInterval(updateContent, 60000);
    </script>
  </body>
</html>
